{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Younes/younes-translator/lib/supabase.js"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nconst URL = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst ANON = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\nconst SERVICE = process.env.SUPABASE_SERVICE_ROLE_KEY || '';\r\n\r\nexport const supabase = createClient(URL, ANON); // safe for client\r\nexport const supabaseAdmin = SERVICE ? createClient(URL, SERVICE) : null; // server-only\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM;AACN,MAAM;AACN,MAAM,UAAU,QAAQ,GAAG,CAAC,yBAAyB,IAAI;AAElD,MAAM,WAAW,IAAA,iKAAY,EAAC,KAAK,OAAO,kBAAkB;AAC5D,MAAM,gBAAgB,UAAU,IAAA,iKAAY,EAAC,KAAK,WAAW,MAAM,cAAc","debugId":null}},
    {"offset": {"line": 45, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Younes/younes-translator/pages/api/translate.js"],"sourcesContent":["import translate from 'google-translate-api-x';\r\nimport { supabase } from \"../../lib/supabase\";\r\n\r\n// normalize function for DB matching\r\nfunction normalize(s = \"\") {\r\n  return s.trim().toLowerCase().replace(/\\s+/g, ' ');\r\n}\r\n\r\nexport default async function handler(req, res) {\r\n  try {\r\n    const { text, target } = req.query;\r\n    if (!text || !target) return res.status(400).json({ translation: null, error: \"Missing text or target\" });\r\n\r\n    const normalizedText = normalize(text);\r\n\r\n    // Check approvedcorrection first\r\n    const { data: approved, error } = await supabase\r\n      .from(\"approvedcorrection\")\r\n      .select(\"user_translation\")\r\n      .eq(\"original\", normalizedText)\r\n      .single();\r\n\r\n    if (approved?.user_translation) {\r\n      return res.status(200).json({ translation: approved.user_translation });\r\n    }\r\n\r\n    // fallback to Google Translate\r\n    const result = await translate(text, { to: target });\r\n    const translation = result?.text ?? null;\r\n\r\n    return res.status(200).json({ translation });\r\n  } catch (err) {\r\n    console.error(err);\r\n    return res.status(500).json({ error: err.message });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,qCAAqC;AACrC,SAAS,UAAU,IAAI,EAAE;IACvB,OAAO,EAAE,IAAI,GAAG,WAAW,GAAG,OAAO,CAAC,QAAQ;AAChD;AAEe,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,IAAI,KAAK;QAClC,IAAI,CAAC,QAAQ,CAAC,QAAQ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,aAAa;YAAM,OAAO;QAAyB;QAEvG,MAAM,iBAAiB,UAAU;QAEjC,iCAAiC;QACjC,MAAM,EAAE,MAAM,QAAQ,EAAE,KAAK,EAAE,GAAG,MAAM,oHAAQ,CAC7C,IAAI,CAAC,sBACL,MAAM,CAAC,oBACP,EAAE,CAAC,YAAY,gBACf,MAAM;QAET,IAAI,UAAU,kBAAkB;YAC9B,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,aAAa,SAAS,gBAAgB;YAAC;QACvE;QAEA,+BAA+B;QAC/B,MAAM,SAAS,MAAM,IAAA,kKAAS,EAAC,MAAM;YAAE,IAAI;QAAO;QAClD,MAAM,cAAc,QAAQ,QAAQ;QAEpC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE;QAAY;IAC5C,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO,IAAI,OAAO;QAAC;IACnD;AACF","debugId":null}}]
}